# Project-TMS-DS

Дипломный проект по курсу Data Scince от TeachMeSkills.

Цель проекта создать аналог игры БлэкДжэк для локального использования.
В данной работе использовалась нейросеть YOLO для определения карт, а также был написан алгоритм для автоматизированного подсета очков и выявления победителя.

## 1. Подготовка данных
Для дообучения модели нужно было найти изображения карт, которые подходили под имеющуюся на руках колоду карт. На сайте [Robowlof](https://roboflow.com/) были найдены два датасета, которые хорошо к этому подошли.

**Вот ссылки на дасеты:**

https://universe.roboflow.com/augmented-startups/playing-cards-ow27d

https://universe.roboflow.com/fh-cards/cards-and-such/dataset/1
## 2. Выбор модели
После подготовки данных нам надо определиться, какую модель YOLO лучше использовать. На изображении снизу предаставлены характеристики моделей YOLO


<p align="center">
  <img src= https://github.com/user-attachments/assets/17ebce5a-c22c-414c-a70d-258084fe6f4d /> 
</p>
<p align="center">
  Характеристики моделей
</p>

Проанализировав и обратив внимание на технические характеристики, точность и время отработки моделей приходим к выводу, что лучше всего к нашей задаче подходит **yolov10(s)**.
Вот на изображении показана архитектура модели **yolov10**:
<p align="center">
  <img src= https://github.com/user-attachments/assets/8ecfa55f-9b88-49d1-ae33-40b1c251f848 /> 
</p>
<p align="center">
  Архитектура модели
</p>

**Backbone** - отвечает за извлечение признаков, использует улучшеную версию CSPNet(Cross Stage Partiel Network) для улучшения градиентного потока и сниежния вычислительной избыточности.

**Neck** - объединение признаков из разных мастштабов и передачи их в головую. Включает в себя еще PAN (Path Aggregation Network), PSA (Partial Self-Attention) для эффективного слияния многомасштабных признаков

**One-to-Many Head** - генерирует несколько прогнозов для каждого объекта во время обучения, чтобы обеспечить расширенные контрольные сигналы и повысить точность обучения.

**One-to-One Head** - генерирует один наилучший прогноз для каждого объекта во время вывода, чтобы исключить необходимость в NMS(Non-Maximum Suppression), тем самым сокращая задержку и повышая эффективность.

## 3. Алгоритм подсчета

Алгоритм  подсчета работл в соответствии следующим правилам:
* Дилеру и игроку раздается по две карты.
* Значение очков: от двойки до десятки(2 - 10); у короля, валета и дамы 10 очков, а у туза 1 или 11(в зависимости от решения игрока).
* Первым берет новые карты игрок и его задача собрать как можно больше очков, но не выше 21.  Если он собрал больше 21, то он сразу проигрывает и дилеру не надо даже брать новые карты.
* Ситуация при ничье называется Push, соответственно победителя нет.
* Если игрок понимает, что у него на руке плохие карты, то он вправе отказаться от игры(surrender) .

Особенностью алгоритма заключается в автоматическом подсчете очков и выбора приоритета для игрока. Пример работы можно будет увидеть в [презентации к защите проекта](https://www.canva.com/design/DAGWfRzK2ms/5moI5TH8c73IWeEHATYs9w/view?utm_content=DAGWfRzK2ms&utm_campaign=designshare&utm_medium=link&utm_source=editor)

## 4. Доставление для пользователя

Для удобного использования игры был написан сайт. Реализовано два режима:
* Игра
* Проверка карт
  
Проверка сделана для того, чтобы можно было убедиться в работе алгоритма подсчета и деткции карт от нейросети. Были также реализованы кнопки **Хода**, **Паса** и **Отказа**. Вот реализации самого сайта:
<p align="center">
  <img src=https://github.com/user-attachments/assets/98b46e13-d587-49c8-9ae9-7bed0f0c0398 /> 
</p>
<p align="center">
  Сайт игры
</p>

## 5. Итоги

Итоговую реализацию проекта можно увидеть в [презентации к защите проекта](https://www.canva.com/design/DAGWfRzK2ms/5moI5TH8c73IWeEHATYs9w/view?utm_content=DAGWfRzK2ms&utm_campaign=designshare&utm_medium=link&utm_source=editor).

Стек технологий: **Docker**, **Flask**, **YOLO**, **OpenCV**.

Особенностями в развертывания этого прокта:
* Две камеры(желательно с хорошим качестом и настраеваемым фокусом);
* Развертывание на Linux(на Windows есть проблема с подключением камер) или с использованием ВМ;
* Если колода карт меняется, то следует и заново обучить модель + модель можно использовать нетолько для этой игры, но и для других карточных игр
  
